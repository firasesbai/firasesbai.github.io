<!DOCTYPE html> <html lang="en"><head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Building Semantic Search for This Blog | Firas Esbai</title> <meta name="generator" content="Jekyll v4.3.4"/> <meta property="og:title" content="Building Semantic Search for This Blog"/> <meta name="author" content="Firas Esbai"/> <meta property="og:locale" content="en_US"/> <meta name="description" content="Guide on how to build a semantic search using fastapi, faiss and sentence-transformers on google cloud"/> <meta property="og:description" content="Guide on how to build a semantic search using fastapi, faiss and sentence-transformers on google cloud"/> <link rel="canonical" href="https://www.firasesbai.com/articles/2026/01/24/building-semantic-search.html"/> <meta property="og:url" content="https://www.firasesbai.com/articles/2026/01/24/building-semantic-search.html"/> <meta property="og:site_name" content="Firas Esbai"/> <meta property="og:image" content="https://www.firasesbai.com/assets/images/default-seo-tag-image.png"/> <meta property="og:image:height" content="630"/> <meta property="og:image:width" content="1200"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2026-01-24T00:00:00+00:00"/> <meta name="twitter:card" content="summary_large_image"/> <meta property="twitter:image" content="https://www.firasesbai.com/assets/images/default-seo-tag-image.png"/> <meta property="twitter:title" content="Building Semantic Search for This Blog"/> <script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Firas Esbai"},"dateModified":"2026-02-04T10:05:42+00:00","datePublished":"2026-01-24T00:00:00+00:00","description":"Guide on how to build a semantic search using fastapi, faiss and sentence-transformers on google cloud","headline":"Building Semantic Search for This Blog","image":{"height":630,"width":1200,"url":"https://www.firasesbai.com/assets/images/default-seo-tag-image.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.firasesbai.com/articles/2026/01/24/building-semantic-search.html"},"url":"https://www.firasesbai.com/articles/2026/01/24/building-semantic-search.html"}</script> <link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://www.firasesbai.com/feed.xml" title="Firas Esbai"/> <script async src="https://www.googletagmanager.com/gtag/js?id='G-3ET85T3WD3'"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-3ET85T3WD3");</script> </head> <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"/> <script>!function(e,t,n,s,c,a,i){e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},(a=t.createElement(n)).async=1,a.src=s,(i=t.getElementsByTagName(n)[0]).parentNode.insertBefore(a,i)}(window,document,"script","https://assets.mailerlite.com/js/universal.js","ml"),ml("account","1240462");</script> <link rel="stylesheet" href="/assets/css/bundles/global.css"> <link rel="stylesheet" href="/assets/css/bundles/post.css"> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png?v=1"> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png?v=1"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png?v=1"> <link rel="manifest" href="/assets/favicon/site.webmanifest"> <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg?v=1" color="#5bbad5"> <link rel="shortcut icon" href="/assets/favicon/favicon.ico?v=1"> <meta name="msapplication-TileColor" content="#da532c"> <meta name="theme-color" content="#ffffff"> <script type="text/javascript" src="/js/service-worker/service-worker.js"></script> <script async src="https://www.googletagmanager.com/gtag/js?id='G-3ET85T3WD3'"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-3ET85T3WD3");</script> <body><header class="site-header" role="banner"> <div class="wrapper"><a class="site-title" href="/" style="font-size: 26px"> Firas Esbai </a><nav class="site-nav"> <input type="checkbox" id="nav-trigger" class="nav-trigger"/> <label for="nav-trigger"> <span class="menu-icon"> <svg viewBox="0 0 18 15" width="18px" height="15px"> <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/> </svg> </span> </label> <div class="trigger"> <a class="page-link" href="/blog/index.html" style="font-size: 20px">Blog</a> <a class="page-link" href="/contact/" style="font-size: 20px">Contact</a> </div> </nav></div> </header><main class="page-content" aria-label="Content"> <div class="wrapper"> <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting"> <nav aria-label="breadcrumb"> <p class="breadcrumb"> <a href="/blog">Blog</a> > <a href="/categories/ai-engineering">AI Engineering</a> > <span>Building Semantic Search for This Blog</span> </p> </nav> <header class="post-header"> <h1 class="post-title p-name" itemprop="name headline">Building Semantic Search for This Blog</h1> <div class="post-tags"> <a href="/archive/#ai-engineering" class="post-tag-badge">AI Engineering</a> </div> <p class="post-meta"><time class="dt-published" datetime="2026-01-24T00:00:00+00:00" itemprop="datePublished"> January 24, 2026 - </time> <span class="reading-time" title="Estimated read time"> 7 min read </span> <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span class="p-author h-card" itemprop="name"> - Firas Esbai</span></span></p> <p class="post-meta last-updated"> Last updated: <time datetime="2026-02-04T10:05:42+00:00" itemprop="dateModified"> February 04, 2026 </time> </p> </header> <div class="post-content e-content" itemprop="articleBody"> <p><em>In this article, I will guide you on how I build and integrated semantic search using Google Cloud for my site.</em></p> <p>We all have seen the exponential adoption of Large Language Models (LLMs) since the release of ChatGPT on November 2022 and the headlines that promise us something new every year; from Model Context Protocol (MCP) and CLI Coding Agents to autonomous multi-agents systems and Context Graphs, the list goes on. Taking a step back, this article is my first attempt to show you how to build AI use cases that actually work. Building is a great way of learning while also gaining insights into how these systems work under the hood.</p> <p><em>So let’s get started!</em></p> <hr/> <h1> Contents </h1> <ul id="markdown-toc"> <li><a href="#what-is-semantic-search" id="markdown-toc-what-is-semantic-search">What is Semantic Search?</a></li> <li><a href="#the-architecture" id="markdown-toc-the-architecture">The Architecture</a></li> <li><a href="#tech-stack-choices" id="markdown-toc-tech-stack-choices">Tech Stack Choices</a></li> <li><a href="#challenges-and-optimizations" id="markdown-toc-challenges-and-optimizations">Challenges and Optimizations</a> <ul> <li><a href="#building-the-faiss-index" id="markdown-toc-building-the-faiss-index">Building the FAISS Index</a></li> <li><a href="#automatic-index-updates" id="markdown-toc-automatic-index-updates">Automatic Index Updates</a></li> <li><a href="#cold-start" id="markdown-toc-cold-start">Cold Start</a></li> <li><a href="#cost-optimization" id="markdown-toc-cost-optimization">Cost Optimization</a></li> </ul> </li> <li><a href="#whats-next" id="markdown-toc-whats-next">What’s Next?</a></li> </ul> <hr/> <h2 id="what-is-semantic-search">What is Semantic Search?</h2> <p>Semantic search is a way of finding information by meaning rather than exact keywords.<br/> Unlike traditional keyword search where the literal words in your query are matched to the same words in documents, semantic search converts both the query and the documents into vectors, known as <em>embeddings</em> that capture their meaning. In essence, it is a nearest-neighbor search problem where, given a query, the top most <em>semantically similar</em> items or vectors are retrieved based on some heuristic used to calculate the likelihood. The naive solution is k-nearest neighbors (k-NN), which in the context of our blog would follow these steps:</p> <ol> <li>Split all the blog posts into chunks, generate embeddings and save them into a vector store.</li> <li>Given a new search query, convert it to a vector embedding.</li> <li>Compute the similarity scores between the query embedding and all vectors in the database, using metrics such as cosine similarity.</li> <li>Rank all vectors by their similarity scores.</li> <li>Return <em>k</em> vectors with the highest similarity scores.</li> </ol> <h2 id="the-architecture">The Architecture</h2> <p>Before diving into implementation details, here’s the high-level architecture:</p> <div class="jekyll-diagrams diagrams mermaid"> <svg id="my-svg" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="flowchart" style="max-width: 501.422px; background-color: white;" viewBox="0 0 501.421875 578" role="graphics-document document" aria-roledescription="flowchart-v2"><style>#my-svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333}@keyframes edge-animation-frame{from{stroke-dashoffset:0}}@keyframes dash{to{stroke-dashoffset:0}}#my-svg .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round}#my-svg .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round}#my-svg .error-icon{fill:#522}#my-svg .error-text{fill:#522;stroke:#522}#my-svg .edge-thickness-normal{stroke-width:1px}#my-svg .edge-thickness-thick{stroke-width:3.5px}#my-svg .edge-pattern-solid{stroke-dasharray:0}#my-svg .edge-thickness-invisible{stroke-width:0;fill:none}#my-svg .edge-pattern-dashed{stroke-dasharray:3}#my-svg .edge-pattern-dotted{stroke-dasharray:2}#my-svg .marker{fill:#333;stroke:#333}#my-svg .marker.cross{stroke:#333}#my-svg svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px}#my-svg p{margin:0}#my-svg .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333}#my-svg .cluster-label text{fill:#333}#my-svg .cluster-label span{color:#333}#my-svg .cluster-label span p{background-color:transparent}#my-svg .label text,#my-svg span{fill:#333;color:#333}#my-svg .node rect,#my-svg .node circle,#my-svg .node ellipse,#my-svg .node polygon,#my-svg .node path{fill:#ececff;stroke:#9370db;stroke-width:1px}#my-svg .rough-node .label text,#my-svg .node .label text,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-anchor:middle}#my-svg .node .katex path{fill:#000;stroke:#000;stroke-width:1px}#my-svg .rough-node .label,#my-svg .node .label,#my-svg .image-shape .label,#my-svg .icon-shape .label{text-align:center}#my-svg .node.clickable{cursor:pointer}#my-svg .root .anchor path{fill:#333!important;stroke-width:0;stroke:#333}#my-svg .arrowheadPath{fill:#333}#my-svg .edgePath .path{stroke:#333;stroke-width:2px}#my-svg .flowchart-link{stroke:#333;fill:none}#my-svg .edgeLabel{background-color:rgba(232,232,232,0.8);text-align:center}#my-svg .edgeLabel p{background-color:rgba(232,232,232,0.8)}#my-svg .edgeLabel rect{opacity:.5;background-color:rgba(232,232,232,0.8);fill:rgba(232,232,232,0.8)}#my-svg .labelBkg{background-color:rgba(232,232,232,0.5)}#my-svg .cluster rect{fill:#ffffde;stroke:#aa3;stroke-width:1px}#my-svg .cluster text{fill:#333}#my-svg .cluster span{color:#333}#my-svg div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80,100%,96.2745098039%);border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#my-svg .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333}#my-svg rect.text{fill:none;stroke-width:0}#my-svg .icon-shape,#my-svg .image-shape{background-color:rgba(232,232,232,0.8);text-align:center}#my-svg .icon-shape p,#my-svg .image-shape p{background-color:rgba(232,232,232,0.8);padding:2px}#my-svg .icon-shape rect,#my-svg .image-shape rect{opacity:.5;background-color:rgba(232,232,232,0.8);fill:rgba(232,232,232,0.8)}#my-svg .label-icon{display:inline-block;height:1em;overflow:visible;vertical-align:-0.125em}#my-svg .node .label-icon path{fill:currentColor;stroke:revert;stroke-width:revert}#my-svg :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif}#my-svg .blue&gt;*{fill:#4285f4!important;stroke:#1a73e8!important;color:#fff!important}#my-svg .blue span{fill:#4285f4!important;stroke:#1a73e8!important;color:#fff!important}#my-svg .blue tspan{fill:#fff!important}#my-svg .orange&gt;*{fill:#f38020!important;stroke:#f38020!important;color:#fff!important}#my-svg .orange span{fill:#f38020!important;stroke:#f38020!important;color:#fff!important}#my-svg .orange tspan{fill:#fff!important}#my-svg .green&gt;*{fill:#34a853!important;stroke:#188038!important;color:#fff!important}#my-svg .green span{fill:#34a853!important;stroke:#188038!important;color:#fff!important}#my-svg .green tspan{fill:#fff!important}</style><g><marker id="my-svg_flowchart-v2-pointEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-pointStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="4.5" refY="5" markerUnits="userSpaceOnUse" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0 5 L 10 10 L 10 0 z" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleEnd" class="marker flowchart-v2" viewBox="0 0 10 10" refX="11" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-circleStart" class="marker flowchart-v2" viewBox="0 0 10 10" refX="-1" refY="5" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><circle cx="5" cy="5" r="5" class="arrowMarkerPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossEnd" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="12" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><marker id="my-svg_flowchart-v2-crossStart" class="marker cross flowchart-v2" viewBox="0 0 11 11" refX="-1" refY="5.2" markerUnits="userSpaceOnUse" markerWidth="11" markerHeight="11" orient="auto"><path d="M 1,1 l 9,9 M 10,1 l -9,9" class="arrowMarkerPath" style="stroke-width: 2; stroke-dasharray: 1, 0;"/></marker><g class="root"><g class="clusters"><g class="cluster" id="subGraph1" data-look="classic"><rect style="" x="8" y="314" width="307.140625" height="256"/><g class="cluster-label" transform="translate(112.6484375, 314)"><foreignObject width="97.84375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Google Cloud</p></span></div></foreignObject></g></g><g class="cluster" id="GitHub" data-look="classic"><rect style="" x="48.92578125" y="8" width="240.234375" height="232"/><g class="cluster-label" transform="translate(144.14453125, 8)"><foreignObject width="49.796875" height="24"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>GitHub</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path d="M169.043,87L169.043,93.167C169.043,99.333,169.043,111.667,169.043,123.333C169.043,135,169.043,146,169.043,151.5L169.043,157" id="L_Blog_Repo_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Blog_Repo_0" data-points="W3sieCI6MTY5LjA0Mjk2ODc1LCJ5Ijo4N30seyJ4IjoxNjkuMDQyOTY4NzUsInkiOjEyNH0seyJ4IjoxNjkuMDQyOTY4NzUsInkiOjE2MX1d" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M169.043,215L169.043,219.167C169.043,223.333,169.043,231.667,169.043,242C169.043,252.333,169.043,264.667,169.043,277C169.043,289.333,169.043,301.667,169.043,311.333C169.043,321,169.043,328,169.043,331.5L169.043,335" id="L_Repo_AR_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_Repo_AR_0" data-points="W3sieCI6MTY5LjA0Mjk2ODc1LCJ5IjoyMTV9LHsieCI6MTY5LjA0Mjk2ODc1LCJ5IjoyNDB9LHsieCI6MTY5LjA0Mjk2ODc1LCJ5IjoyNzd9LHsieCI6MTY5LjA0Mjk2ODc1LCJ5IjozMTR9LHsieCI6MTY5LjA0Mjk2ODc1LCJ5IjozMzl9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M186.419,393L191.675,401.167C196.93,409.333,207.442,425.667,234.104,441.815C260.766,457.963,303.579,473.927,324.986,481.909L346.393,489.89" id="L_AR_External_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_AR_External_0" data-points="W3sieCI6MTg2LjQxODk0NTMxMjUsInkiOjM5M30seyJ4IjoyMTcuOTUzMTI1LCJ5Ijo0NDJ9LHsieCI6MzUwLjE0MDYyNSwieSI6NDkxLjI4Nzg0OTc1MDg2MjR9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/><path d="M151.667,393L146.411,401.167C141.156,409.333,130.644,425.667,125.389,441.333C120.133,457,120.133,472,120.133,479.5L120.133,487" id="L_AR_CR_0" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" style=";" data-edge="true" data-et="edge" data-id="L_AR_CR_0" data-points="W3sieCI6MTUxLjY2Njk5MjE4NzUsInkiOjM5M30seyJ4IjoxMjAuMTMyODEyNSwieSI6NDQyfSx7IngiOjEyMC4xMzI4MTI1LCJ5Ijo0OTF9XQ==" marker-end="url(#my-svg_flowchart-v2-pointEnd)"/></g><g class="edgeLabels"><g class="edgeLabel" transform="translate(169.04296875, 124)"><g class="label" data-id="L_Blog_Repo_0" transform="translate(-29.046875, -12)"><foreignObject width="58.09375" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>Triggers</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(169.04296875, 277)"><g class="label" data-id="L_Repo_AR_0" transform="translate(-42.25, -12)"><foreignObject width="84.5" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>Build Image</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(217.953125, 442)"><g class="label" data-id="L_AR_External_0" transform="translate(-52.9140625, -24)"><foreignObject width="105.828125" height="48"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>Fetch All Posts<br/>Build Index</p></span></div></foreignObject></g></g><g class="edgeLabel" transform="translate(120.1328125, 442)"><g class="label" data-id="L_AR_CR_0" transform="translate(-24.90625, -12)"><foreignObject width="49.8125" height="24"><div xmlns="http://www.w3.org/1999/xhtml" class="labelBkg" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>Deploy</p></span></div></foreignObject></g></g></g><g class="nodes"><g class="node default green" id="flowchart-Blog-0" transform="translate(169.04296875, 60)"><rect class="basic label-container" style="fill:#34a853 !important;stroke:#188038 !important" x="-82.46875" y="-27" width="164.9375" height="54"/><g class="label" style="color:#fff !important" transform="translate(-52.46875, -12)"><rect/><foreignObject width="104.9375" height="24"><div style="color: rgb(255, 255, 255) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span style="color:#fff !important" class="nodeLabel"><p>New Blog Post</p></span></div></foreignObject></g></g><g class="node default green" id="flowchart-Repo-1" transform="translate(169.04296875, 188)"><rect class="basic label-container" style="fill:#34a853 !important;stroke:#188038 !important" x="-85.1171875" y="-27" width="170.234375" height="54"/><g class="label" style="color:#fff !important" transform="translate(-55.1171875, -12)"><rect/><foreignObject width="110.234375" height="24"><div style="color: rgb(255, 255, 255) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span style="color:#fff !important" class="nodeLabel"><p>CI/CD workflow</p></span></div></foreignObject></g></g><g class="node default blue" id="flowchart-CR-2" transform="translate(120.1328125, 518)"><rect class="basic label-container" style="fill:#4285f4 !important;stroke:#1a73e8 !important" x="-67.8046875" y="-27" width="135.609375" height="54"/><g class="label" style="color:#fff !important" transform="translate(-37.8046875, -12)"><rect/><foreignObject width="75.609375" height="24"><div style="color: rgb(255, 255, 255) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span style="color:#fff !important" class="nodeLabel"><p>Cloud Run</p></span></div></foreignObject></g></g><g class="node default blue" id="flowchart-AR-3" transform="translate(169.04296875, 366)"><rect class="basic label-container" style="fill:#4285f4 !important;stroke:#1a73e8 !important" x="-86.4609375" y="-27" width="172.921875" height="54"/><g class="label" style="color:#fff !important" transform="translate(-56.4609375, -12)"><rect/><foreignObject width="112.921875" height="24"><div style="color: rgb(255, 255, 255) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span style="color:#fff !important" class="nodeLabel"><p>Artifact Registry</p></span></div></foreignObject></g></g><g class="node default orange" id="flowchart-External-4" transform="translate(421.78125, 518)"><rect class="basic label-container" style="fill:#f38020 !important;stroke:#f38020 !important" x="-71.640625" y="-27" width="143.28125" height="54"/><g class="label" style="color:#fff !important" transform="translate(-41.640625, -12)"><rect/><foreignObject width="83.28125" height="24"><div style="color: rgb(255, 255, 255) !important; display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;" xmlns="http://www.w3.org/1999/xhtml"><span style="color:#fff !important" class="nodeLabel"><p>My Website</p></span></div></foreignObject></g></g></g></g></g></svg> </div> <p style="text-align:center;">Figure 1: High Level Architecture</p> <p><strong>The flow is simple:</strong></p> <ol> <li>When I publish a new blog post, a GitHub workflow is triggered to rebuild the image of the backend serving the semantic search endpoint.</li> <li>Building the image involves fetching posts from the website, generating embeddings, and building a search index</li> <li>The image is pushed to Artifact Registry and deployed to Cloud Run</li> </ol> <p>With the high level flow defined, in the following sections we look in more details into the constraints that influenced the tech stack choices, faced challenges and implemented optimizations.</p> <h2 id="tech-stack-choices">Tech Stack Choices</h2> <p>With the objective of keeping cost to a minimum, yet still having fast deployments, minimal operations and easily scalable solution, choosing a fully managed serverless platform for deploying the backend service became the clear answer. In addition, the generous free tier of Google Cloud made the decision easier to go with <strong>Cloud Run</strong>. Cloud Run enables you to run stateless containers on top of Google’s scalable infrastructure. <br/> The free tier includes 2 million requests/month and enough memory and compute time for the amount of traffic that I’m expecting. Crossing these limits would only cost pennies on the dollar given that you only pay for what you use and you can always scale it down to zero. For more information on free tier usage limits, you can check <a href="https://docs.cloud.google.com/free/docs/free-cloud-features#cloud-run">this page</a>.</p> <p>Considering the choice of Cloud Run and the number of blog posts and expected size of the generated embeddings, I decided to go with an in-memory vector database. <strong>FAISS</strong> is Facebook’s similarity search library. It is fast, in-memory and suitable for this scale. FAISS builds an index for fast similarity search and instead of comparing the query to every post which can be slow, it uses smart data structures to find the nearest neighbors quickly. Another required component that goes hand in hand with this is an embedding model. I used <strong>sentence-transformers</strong> library. It is a python framework for accessing and using state of the art embedding models. In addition, to keep the image size reduced, I used the<code class="language-plaintext highlighter-rouge">all-MiniLM-L6-v2</code> model which is around 90MB and generates 384-dimensional vectors.</p> <p>Regarding the backend, I used <strong>FastAPI</strong>; modern, fast and high-performance web framework for building python based APIs with automatic API docs, and excellent type safety with Pydantic.</p> <h2 id="challenges-and-optimizations">Challenges and Optimizations</h2> <h3 id="building-the-faiss-index">Building the FAISS Index</h3> <p>In order to have faster container startup, I build the FAISS index during Docker image creation, not at runtime. This ensures consistent results across all instances since the filesystem is ephemeral and no external dependencies at runtime.</p> <h3 id="automatic-index-updates">Automatic Index Updates</h3> <p>We keep the blog and the search backend in separate repositories to keep concerns isolated and releases simple. The open question was: how do we update the search index whenever a new post goes live?</p> <p>To solve this, I added a GitHub Actions workflow in the blog repo that triggers on publishing and calls the GitHub REST API to send a <code class="language-plaintext highlighter-rouge">repository_dispatch</code> event to the backend repo with a custom <code class="language-plaintext highlighter-rouge">event_type=blog-updated</code>. The backend repo has a workflow that listens for that event; when it matches, it builds and deploys the Docker image and refreshes the index.</p> <h3 id="cold-start">Cold Start</h3> <p>When Cloud Run scales from zero, it takes between 5 and 10 seconds to start a container. This time includes the container startup time and loading of the embedding model as well as the FAISS index.</p> <p>Cloud Run has the option to allocate extra CPU during startup and which can be activated by this flag:</p> <p><code class="language-plaintext highlighter-rouge">--cpu-boost</code></p> <p>In comparison to the size of the FAISS index, loading the embedding model, even a small one, on every cold start is slow. One solution to this would be caching the model to a specific location inside the container by adding the following line in your Dockerfile:</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby">      
    <span class="no">RUN</span> <span class="n">mkdir</span> <span class="o">-</span><span class="nb">p</span> <span class="sr">/app/mo</span><span class="n">dels</span> <span class="o">&amp;&amp;</span> <span class="p">\</span>
    <span class="sr">/app/</span><span class="p">.</span><span class="nf">venv</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s2">"from sentence_transformers import SentenceTransformer; model = SentenceTransformer('all-MiniLM-L6-v2'); model.save('/app/models/all-MiniLM-L6-v2')"</span>
   
   </code></pre></figure> <p>While keeping the minimum number of running instances set to 1 would solve the issue of the cold start completely, it would also result in extra costs. Depending on your traffic and usage of the search functionality in your system, you can opt for this alternative. For me the objective was to build and test the sematic search end to end and even though I could still face timeout errors occasionally when searching it is still acceptable for now.</p> <h3 id="cost-optimization">Cost Optimization</h3> <p>Since Cloud Run charges for the resources you use and in order not incur additional costs after the free tier limits, the service shuts down and scales back to zero when there’s no traffic and the Cloud Run service is idle. However, each time a new post is published, this results in a new image version. To avoid storage costs and stay within the free tier limit of Artifact Registry which is &lt; 0.5 GB, I have applied the following cleanup policy to keep only the last 2 docker images:</p> <figure class="highlight"><pre><code class="language-ruby" data-lang="ruby">      
    <span class="p">{</span>
        <span class="s2">"name"</span><span class="p">:</span> <span class="s2">"keep-recent-2"</span><span class="p">,</span>
        <span class="s2">"action"</span><span class="p">:</span> <span class="s2">"DELETE"</span><span class="p">,</span>
        <span class="s2">"condition"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"tagState"</span><span class="p">:</span> <span class="s2">"UNTAGGED"</span><span class="p">,</span>
            <span class="s2">"newerThan"</span><span class="p">:</span> <span class="s2">"0s"</span>
        <span class="p">},</span>
        <span class="s2">"mostRecentVersions"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">"keepCount"</span><span class="p">:</span> <span class="mi">2</span>
        <span class="p">}</span>
    <span class="p">}</span>
   
   </code></pre></figure> <h2 id="whats-next">What’s Next?</h2> <p>Building a semantic search doesn’t require expensive infrastructure. With open-source tools and serverless platforms, you can build production-quality services that scale and cost almost nothing. Having the core architecture in place, adding new use cases such as a recommendations endpoint based on the existing similarity search and vector database or potentially combining the semantic search with keyword matching for better results are now easier. Avoiding over engineered solutions and solving the problems as they araise avoids pre mature unnecessary optimizations.</p> <p>I’d love to hear your thoughts and know more about what AI projects you’re currently working on.</p> <p>With this we have reached the end of this post, I hope you enjoyed it!</p> <p>If you have any remarks or questions, please don’t hesitate and do drop a comment below.</p> <p><em>Stay tuned!</em></p> </div> <hr> <br> <div class="ml-embedded" data-form="T82iSQ"></div> <br> <hr> <br> <div id="relatedPosts"> <div class="post-header bg-"> <h1 class="page-heading">Further Reading</h1> </div> <div id="similar-posts-container"> <div id="similar-posts-loading" style="text-align: center; padding: 20px; color: #6c757d;"> <p>Loading similar posts...</p> </div> <div id="similar-posts-error" style="display: none;"> <p class="no-related">Unable to load recommendations. <a href="/archive/">Explore the archive</a> to discover more articles.</p> </div> <div id="similar-posts-results"></div> </div> <div id="tag-based-related" style="display: none;"> <div class="related-post-item"> <h3><a href="/articles/2026/02/04/ai-coding-agents.html">AI Coding Agents: A Practical Guide</a></h3> <p class="related-meta"> <span class="related-date">February 04, 2026</span> <span class="related-tags"> <span class="tag-badge">AI Engineering</span> </span> </p> </div> <div class="related-post-item"> <h3><a href="/articles/2026/01/11/data-platform-engineering.html">Data Platform Engineering</a></h3> <p class="related-meta"> <span class="related-date">January 11, 2026</span> <span class="related-tags"> <span class="tag-badge">AI Engineering</span> </span> </p> </div> <div class="related-post-item"> <h3><a href="/articles/2025/09/25/vibe-coding-learnings.html">Learnings from Vibe Coding</a></h3> <p class="related-meta"> <span class="related-date">September 25, 2025</span> <span class="related-tags"> <span class="tag-badge">AI Engineering</span> </span> </p> </div> </div> </div> <script>!function(){"use strict";async function t(){const t=document.getElementById("similar-posts-loading"),s=(document.getElementById("similar-posts-error"),document.getElementById("similar-posts-results")),r=document.getElementById("tag-based-related"),l=`similar_posts_${i}`,c=6048e5;try{const n=localStorage.getItem(l);if(n){const{posts:a,timestamp:o}=JSON.parse(n);if(Date.now()-o<c)return t.style.display="none",void e(a,s)}}catch(t){console.log("Cache read failed:",t)}const d=new AbortController,m=setTimeout(()=>d.abort(),o);try{const o=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:i,limit:a}),signal:d.signal});if(clearTimeout(m),!o.ok)throw new Error(`HTTP ${o.status}`);const r=await o.json();if(t.style.display="none",r.similar_posts&&r.similar_posts.length>0){e(r.similar_posts,s);try{localStorage.setItem(l,JSON.stringify({posts:r.similar_posts,timestamp:Date.now()}))}catch(t){console.log("Cache write failed:",t)}}else s.innerHTML='<p class="no-related">No related posts found. <a href="/archive/">Explore the archive</a> to discover more articles.</p>'}catch(e){clearTimeout(m),console.error("Error loading similar posts:",e),t.style.display="none",r.style.display="block"}}function e(t,e){const s=t.map(t=>{const e=new Date(t.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),s=t.tags&&t.tags.length>0?t.tags.map(t=>`<span class="tag-badge">${t}</span>`).join(" "):"",n=Math.round(100*t.score);return`\n        <div class="related-post-item">\n          <h3><a href="${t.url}">${t.title}</a></h3>\n          <p class="related-meta">\n            <span class="related-date">${e}</span>\n            ${s?`<span class="related-tags">${s}</span>`:""}\n            <span class="similarity-score" title="Similarity: ${n}%">\n              <svg width="12" height="12" style="vertical-align: middle; margin-left: 8px;">\n                <circle cx="6" cy="6" r="5" fill="none" stroke="#007bff" stroke-width="1.5"/>\n                <circle cx="6" cy="6" r="5" fill="none" stroke="#007bff" stroke-width="1.5" \n                        stroke-dasharray="${.314*n} 31.4" \n                        stroke-dashoffset="7.85" \n                        transform="rotate(-90 6 6)"/>\n              </svg>\n              ${n}% match\n            </span>\n          </p>\n        </div>\n      `}).join("");e.innerHTML=s}function s(){const e=document.getElementById("relatedPosts");if("IntersectionObserver"in window){const s=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(t(),s.disconnect())})},{rootMargin:"200px"});s.observe(e)}else t()}const n="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://localhost:8080/api/v1/similar":"https://api.firasesbai.com/api/v1/similar",a=4,o=3e4,i="https://www.firasesbai.com/articles/2026/01/24/building-semantic-search.html";"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s()}();</script> <hr> <br> <div id="disqus_thread"></div> <script>!function(){var e=document,t=e.createElement("script");t.src="https://firasesbai.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}();</script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <a class="u-url" href="/articles/2026/01/24/building-semantic-search.html" hidden></a> </article> <script src="/js/reading-progress.js" defer></script> <script src="/js/code-copy.js" defer></script> </div> </main><footer class="site-footer h-card"> <data class="u-url" href="/"></data> <div class="wrapper"> <div class="footer-col-wrapper"> <div class="footer-col footer-col-1" style="text-align: left;"><ul class="social-media-list"><li><a href="https://www.firasesbai.com/feed.xml"><svg class="svg-icon orange"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg><span> Subscribe</span></a></li><li><a href="https://www.linkedin.com/in/firas-esbai"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">firas-esbai</span></a></li><li><a href="https://github.com/firasesbai"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">firasesbai</span></a></li></ul></div> <div class="footer-col footer-col-2" style="text-align: right;"> <ul class="legal-list" style="list-style-type: none; padding: 0;"> <li><a href="/archive/">Archive</a></li> <li><a href="/privacy-policy/">Privacy Policy</a></li> <li><a href="/terms/">Terms and Conditions</a></li> </ul> </div> </div> <div style="text-align: center; margin-top: 10px;"> <p class="p-name">Copyright &copy; 2026 Firas Esbai.</p> </div> </div> </footer> <script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false" defer></script> <script src="/js/cookie-consent-script.js" type="text/javascript" defer></script> </body> </html>