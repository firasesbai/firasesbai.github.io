<!DOCTYPE html>
<html lang="en">
  
  <!-- Cookie Consent CSS -->
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css" />

  <!-- D3js -->
  <script src="https://d3js.org/d3.v7.min.js"></script>

<!-- MailerLite Universal -->
<script>
  (function(w,d,e,u,f,l,n){w[f]=w[f]||function(){(w[f].q=w[f].q||[])
  .push(arguments);},l=d.createElement(e),l.async=1,l.src=u,
  n=d.getElementsByTagName(e)[0],n.parentNode.insertBefore(l,n);})
  (window,document,'script','https://assets.mailerlite.com/js/universal.js','ml');
  ml('account', '1240462');
</script>
<!-- End MailerLite Universal --><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Logging with ELK Stack | Firas Esbai</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Logging with ELK Stack" />
<meta name="author" content="Firas Esbai" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Steps to configure filebeat to collect log files generated by python application running in docker container and saves them to elasticsearch" />
<meta property="og:description" content="Steps to configure filebeat to collect log files generated by python application running in docker container and saves them to elasticsearch" />
<link rel="canonical" href="https://www.firasesbai.com/articles/2022/01/09/logging-with-elasticsearch.html" />
<meta property="og:url" content="https://www.firasesbai.com/articles/2022/01/09/logging-with-elasticsearch.html" />
<meta property="og:site_name" content="Firas Esbai" />
<meta property="og:image" content="https://www.firasesbai.com/assets/images/articles/5_logging_with_elk_stack.PNG" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-01-09T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://www.firasesbai.com/assets/images/articles/5_logging_with_elk_stack.PNG" />
<meta property="twitter:title" content="Logging with ELK Stack" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Firas Esbai"},"dateModified":"2022-01-09T00:00:00+00:00","datePublished":"2022-01-09T00:00:00+00:00","description":"Steps to configure filebeat to collect log files generated by python application running in docker container and saves them to elasticsearch","headline":"Logging with ELK Stack","image":"https://www.firasesbai.com/assets/images/articles/5_logging_with_elk_stack.PNG","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.firasesbai.com/articles/2022/01/09/logging-with-elasticsearch.html"},"url":"https://www.firasesbai.com/articles/2022/01/09/logging-with-elasticsearch.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://www.firasesbai.com/feed.xml" title="Firas Esbai" /><!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id='G-3ET85T3WD3'"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3ET85T3WD3');
</script>
</head>
<!-- insert favicons. use https://realfavicongenerator.net/ -->
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon.png?v=1">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png?v=1">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png?v=1">
  <link rel="manifest" href="/assets/favicon/site.webmanifest">
  <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg?v=1" color="#5bbad5">
  <link rel="shortcut icon" href="/assets/favicon/favicon.ico?v=1">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">

  <!-- service Worker Logic -->	
  <script type="text/javascript" src="/js/service-worker.js"></script>
  
  
  	<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id='G-3ET85T3WD3'"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3ET85T3WD3');
</script>

  
  
  <body><header class="site-header" role="banner">
   <div class="wrapper"><a class="site-title" href="/" style="font-size: 26px"> Firas Esbai </a><nav class="site-nav">
         <input type="checkbox" id="nav-trigger" class="nav-trigger" />
         <label for="nav-trigger">
            <span class="menu-icon">
               <svg viewBox="0 0 18 15" width="18px" height="15px">
                  <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
               </svg>
            </span>
         </label>
         <div class="trigger">
            <!--
               my_page.autogen is populated by the pagination logic for all pages
                               that are automatically created by the gem. Check for non-existence to exclude pagination pages from site.pages iterators
               -->
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
            
               
                  <a class="page-link" href="/blog/index.html" style="font-size: 20px">Blog</a>
               
            
               
                  <a class="page-link" href="/contact/" style="font-size: 20px">Contact Me</a>
               
            

         </div>
      </nav></div>
</header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <link rel="stylesheet" href="/assets/css/post.css">

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <nav aria-label="breadcrumb">
    <p class="breadcrumb">
      <a href="/blog">Blog</a>
      
        
        
        > <a href="/categories/observability">Observability</a>
      
      > <span>Logging with ELK Stack</span>
    </p>
  </nav>

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Logging with ELK Stack</h1>
    <p class="post-meta"><time class="dt-published" datetime="2022-01-09T00:00:00+00:00" itemprop="datePublished">
        Jan 9, 2022 - 
      </time>
      
      <span class="reading-time" title="Estimated read time">
  
  2 min read
</span>
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name"> - Firas Esbai</span></span></p></header>

  <div class="post-content e-content" itemprop="articleBody">
    <p><em>In this article we will discuss how to set up an ELK stack to properly monitor your dockerized application’s logs.</em></p>

<p><strong>All the source code is available <a href="https://github.com/firasesbai/fastapi-elk-stack-logging">here</a>.</strong></p>

<hr />

<h1> Contents </h1>
<ul id="markdown-toc">
  <li><a href="#what-is-the-elastic-stack" id="markdown-toc-what-is-the-elastic-stack">What is the Elastic Stack?</a></li>
  <li><a href="#what-are-beats" id="markdown-toc-what-are-beats">What are Beats?</a></li>
  <li><a href="#architecture" id="markdown-toc-architecture">Architecture</a>    <ul>
      <li><a href="#setup" id="markdown-toc-setup">Setup</a></li>
    </ul>
  </li>
  <li><a href="#recap" id="markdown-toc-recap">Recap</a></li>
  <li><a href="#resources" id="markdown-toc-resources">Resources</a></li>
</ul>
<hr />

<p><em>First let’s start with the basics.</em></p>

<h2 id="what-is-the-elastic-stack">What is the Elastic Stack?</h2>

<p>The Elastic Stack, known as <strong>ELK</strong>, allows us to reliably and securely take data from multiple sources and different formats using the first component of the stack; <strong>Logstash</strong>.</p>

<p>Then we can store, search and analyze it through <strong>Elasticsearch</strong> and finally visualize it in real time using its data visualisation dashboard <strong>Kibana</strong>.</p>

<p>The Elastic Stack can be seen and applied in a variety of use cases such as security analytics, business analytics, metrics and logs aggregation and analysis.</p>

<h2 id="what-are-beats">What are Beats?</h2>

<p>Beats is the new member of the ELK Stack. Beats are light weight log data shippers which can push logs to either Logstash for more processing and transformation or to Elasticsearch.
They sit on your servers, with your containers, or deployed as functions — and then centralize data in Elasticsearch.</p>

<p>In this tutorial we will use <strong>Filebeat</strong> which is an open-source lightweight shipper for logs written in go. 
It uses a backpressure-sensitive protocol when sending data to account for higher volumes of data.</p>

<p>For more info check the official <a href="https://www.elastic.co/beats/filebeat">documentation</a> from elastic.</p>

<h2 id="architecture">Architecture</h2>

<p>After some theoretical introduction about the different components of the ELK stack, let’s dive deeper into the setup of our architecture as illustrated in the diagram below.</p>

<figure>
  <img src="/assets/images/articles/5_logging_with_elk_stack.PNG" alt="architecture of application logs send to elasticsearch and kibana" />
  <figcaption>Figure 1: Architecture Design</figcaption>
</figure>

<p>We will create a single endpoint FastAPI application running in a docker container that generates logs and saves them to files. Filebeat reads then those files and transfers them into Elasticsearch.</p>

<h3 id="setup">Setup</h3>

<ol>
  <li>
    <p>Clone this Github <a href="https://github.com/firasesbai/fastapi-elk-stack-logging">repository</a>, change into the corresponding directory and run the following command: <code class="language-plaintext highlighter-rouge">docker-compose up -d</code></p>

    <p>This will start docker containers for each system shown in the above architecture.</p>
  </li>
  <li>
    <p>Go to <code class="language-plaintext highlighter-rouge">http://127.0.0.1:8000/docs</code> where you will see the Swagger UI of our python application and try out  the endpoint in order to generate some logs.</p>
  </li>
  <li>
    <p>Access the kibana dashboard in your web browser through: <code class="language-plaintext highlighter-rouge">http://127.0.0.1:5601</code></p>

    <p>The first thing you have to do is to configure the ElasticSearch indices that can be displayed in Kibana.
The file <strong>filebeat.yml</strong> found under <a href="https://github.com/firasesbai/fastapi-elk-stack-logging/blob/main/filebeat/filebeat.yml">/filebeat/filebeat.yml</a> indicates the used index for our application.</p>

    <p>For further exploration of the possible Filebeat configuration options you can check this <a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-reference-yml.html">filebeat.reference.yml</a></p>
  </li>
</ol>

<p>That’s it! You can now visualize the logs generated by our application in the kibana interface in real time and apply your filters for further analysis.</p>

<p>With this we have reached the end of this post, I hope you enjoyed it!</p>

<h2 id="recap">Recap</h2>

<p>In this article we discussed the building blocks and the interaction between them to set up an ELK stack to collect logs from a python application running as a docker container necessary for further troubleshooting and monitoring.</p>

<p><em>Happy learning!</em></p>

<h2 id="resources">Resources</h2>

<p><a href="https://www.elastic.co/beats/filebeat">https://www.elastic.co/beats/filebeat</a></p>

<p><a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-reference-yml.html">https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-reference-yml.html</a></p>

  </div>

  <hr>
<br>
<div class="ml-embedded" data-form="T82iSQ"></div>

  <br>
<hr>
<br>
<div id="relatedPosts">
   <div class="post-header bg-">
      <h1 class="page-heading">Further Reading</h1>
   </div>
   
   
   
   
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
    <div>
      <h3><a href="/articles/2023/01/15/prometheus-monitoring.html">Prometheus Monitoring: How to Collect and Analyze Metrics</a></h3>
    </div>
    
    
   
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
   
    
    
    
   
    
    <div>
      <h3><a href="/articles/2021/02/07/kafka-monitoring-part-2.html">Essential Kafka Cluster Metrics: A Comprehensive Monitoring Guide</a></h3>
    </div>
    
    
   
   
    
    
    
   
    
    <div>
      <h3><a href="/articles/2021/01/01/kafka-monitoring.html">Navigating Apache Kafka Monitoring in Real-World Deployments</a></h3>
    </div>
    
    
   
   
</div>

  
    
<hr>
<br>
<div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://firasesbai.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  

  <a class="u-url" href="/articles/2022/01/09/logging-with-elasticsearch.html" hidden></a>
</article>
      </div>
    </main><link rel="stylesheet" href="/assets/css/footer.css">
 
<footer class="site-footer h-card">
   <data class="u-url" href="/"></data>
   <div class="wrapper">
      <div class="footer-col-wrapper">
         <div class="footer-col footer-col-1" style="text-align: left;"><ul class="social-media-list"><li><a href="https://www.firasesbai.com/feed.xml"><svg class="svg-icon orange"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg><span> Subscribe</span></a></li><li><a href="https://www.linkedin.com/in/firas-esbai"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">firas-esbai</span></a></li><li><a href="https://github.com/firasesbai"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">firasesbai</span></a></li></ul></div>
         <div class="footer-col footer-col-2" style="text-align: right;">
            <ul class="legal-list" style="list-style-type: none; padding: 0;">
               <li><a href="/archive/">Archive</a></li>
               <li><a href="/privacy-policy/">Privacy Policy</a></li>
               <li><a href="/terms/">Terms and Conditions</a></li>
            </ul>
         </div>
      </div>
      <div style="text-align: center; margin-top: 10px;">
         
            <p class="p-name">Copyright &copy; 2025 Firas Esbai.</p>
            
      </div>
   </div>
</footer><!-- Cookie Consent Logic -->	
	<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script>
	<script src="/js/cookie-consent-script.js" type="text/javascript"> </script>

  </body>

</html>